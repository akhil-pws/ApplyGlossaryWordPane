!function(){"use strict";var e,t,n,o={14385:function(e){e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},58394:function(e,t,n){e.exports=n.p+"0e7eeeefdf3c0f0acab7.css"}},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return o[e](n,n.exports,a),n.exports}a.m=o,a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e}(),a.b=document.baseURI||self.location.href,function(){let e="",t="",n=[],o=!0,r=[];async function a(){const t=sessionStorage.getItem("token");console.log(t),t?(e=t,window.location.hash="#/dashboard"):(document.getElementById("app-body").innerHTML='\n    <div class="container mt-5">\n      <form id="login-form" class="p-4 border rounded">\n        <div class="mb-3">\n          <label for="organization" class="form-label fw-bold">Organization</label>\n          <input type="text" class="form-control" id="organization" required>\n        </div>\n        <div class="mb-3">\n          <label for="username" class="form-label fw-bold">Username</label>\n          <input type="text" class="form-control" id="username" required>\n        </div>\n        <div class="mb-3">\n          <label for="password" class="form-label fw-bold">Password</label>\n          <input type="password" class="form-control" id="password" required>\n        </div>\n        <div class="d-grid">\n          <button type="submit" class="btn btn-primary">Login</button>\n        </div>\n      </form>\n    </div>\n  ',document.getElementById("login-form").addEventListener("submit",s))}async function s(t){t.preventDefault();const n=document.getElementById("organization").value,o=document.getElementById("username").value,r=document.getElementById("password").value;try{const t=await fetch("https://plsdevapp.azurewebsites.net/api/user/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ClientName:n,Username:o,Password:r})});if(!t.ok)throw new Error("Network response was not ok.");const a=await t.json();console.log("Login successful:",a),e=a.Data.Token,sessionStorage.setItem("token",e),window.location.hash="#/dashboard"}catch(e){console.error("Error during login:",e)}}async function i(t,n){if(t.FilteredReportHeadAIHistoryList&&0!==t.FilteredReportHeadAIHistoryList.length||await async function(t){try{const n=await fetch(`https://plsdevapp.azurewebsites.net/api/report/ai-history/${t.ID}`,{method:"GET",headers:{Authorization:`Bearer ${e}`}});if(!n.ok)throw new Error("Network response was not ok.");const o=await n.json();return t.FilteredReportHeadAIHistoryList=o.Data||[],t.FilteredReportHeadAIHistoryList}catch(e){return console.error("Error fetching AI history:",e),[]}}(t),t.FilteredReportHeadAIHistoryList.length>0){const e=t.FilteredReportHeadAIHistoryList.map(((e,t)=>`<div class="row chatbox">\n        <div class="col-md-12 mt-2 p-2">\n          <span class="ms-3">\n            <i class="fa fa-copy text-secondary c-pointer" title="Copy Response" id="copyPrompt-${n}-${t}"></i>\n          </span>\n          <span class="float-end w-75 me-3">\n            <div class="form-control h-34 d-flex align-items-center dynamic-height user">\n              ${e.Prompt}\n            </div>\n          </span>\n        </div>\n        <div class="col-md-12 mt-2 p-2 d-flex align-items-center">\n          <span class="radio-select">\n            <input class="form-check-input c-pointer" type="radio" name="flexRadioDefault-${n}"\n              id="flexRadioDefault1-${n}-${t}" ${1===e.Selected?"checked":""}>\n          </span>\n          <span class="ms-2 w-75">\n            <div class="form-control h-34 d-flex align-items-center dynamic-height ai-reply ${1===e.Selected?"ai-selected-reply":"bg-light"}">\n              ${e.Response}\n            </div>\n          </span>\n          <span class="ms-2">\n            <i class="fa fa-copy text-secondary c-pointer" title="Copy Response" id="copyResponse-${n}-${t}"></i>\n          </span>\n        </div>\n      </div>`)).join("");return setTimeout((()=>{t.FilteredReportHeadAIHistoryList.forEach(((e,t)=>{document.getElementById(`copyPrompt-${n}-${t}`)?.addEventListener("click",(()=>c(e.Prompt))),document.getElementById(`copyResponse-${n}-${t}`)?.addEventListener("click",(()=>c(e.Response))),document.getElementById(`flexRadioDefault1-${n}-${t}`)?.addEventListener("change",(()=>{return e=n,o=t,void console.log(`Radio button changed for tagIndex ${e}, chatIndex ${o}`);var e,o}))}))}),0),e}return"<div>No AI history available.</div>"}function c(e){const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}async function l(){const e=document.getElementById("app-body");e.innerHTML="";for(let t=0;t<n.length;t++){const o=n[t],r=document.createElement("div");r.classList.add("accordion-item");const a=`flush-headingOne-${t}`,s=`flush-collapseOne-${t}`,c=await i(o,t);r.innerHTML=`\n      <h2 class="accordion-header" id="${a}">\n        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"\n          data-bs-target="#${s}" aria-expanded="false" aria-controls="${s}">\n          ${o.DisplayName}\n        </button>\n      </h2>\n      <div id="${s}" class="accordion-collapse collapse" aria-labelledby="${a}">\n        <div class="accordion-body">\n          ${c}\n        \n        </div>\n      </div>\n    `,e.appendChild(r)}document.querySelectorAll(".accordion-button").forEach((e=>{e.addEventListener("click",(function(){const e=this.nextElementSibling;e&&e.classList&&e.classList.toggle("show")}))})),document.querySelectorAll(".fa-copy").forEach((e=>{e.addEventListener("click",(function(){this.closest(".p-2").querySelector(".form-control").textContent}))}))}function d(){document.getElementById("app-body").innerHTML='\n    <div class="container mt-3">\n      <div class="card">\n        <div class="card-header">\n          <h5 class="card-title">Search Suggestions</h5>\n        </div>\n        <div class="card-body">\n          <div class="form-group">\n            <input type="text" id="search-box" class="form-control" placeholder="Search Suggestions..." />\n          </div>\n          <ul id="suggestion-list" class="list-group mt-2"></ul>\n        </div>\n      </div>\n    </div>\n';const e=document.getElementById("search-box"),t=document.getElementById("suggestion-list");e.addEventListener("input",(function(){const n=e.value.toLowerCase();t.innerHTML="",r.filter((e=>e.DisplayName.toLowerCase().includes(n))).forEach((n=>{const o=document.createElement("li");o.className="list-group-item list-group-item-action",o.textContent=n.DisplayName,o.onclick=()=>{e.value="",t.innerHTML="",async function(e,t){Word.run((async n=>{try{const o=n.document.getSelection();if("TABLE"===t){const t=o.insertParagraph("",Word.InsertLocation.before),n=(new DOMParser).parseFromString(e,"text/html").querySelector("table");if(!n)throw new Error("No table found in the provided HTML.");const r=Array.from(n.querySelectorAll("tr"));if(0===r.length)throw new Error("The table does not contain any rows.");const a=Math.max(...r.map((e=>e.querySelectorAll("td, th").length))),s=t.insertTable(r.length,a,Word.InsertLocation.after);r.forEach(((e,t)=>{Array.from(e.querySelectorAll("td, th")).forEach(((e,n)=>{const o=e.textContent?.trim()||"";console.log(`Row ${t}, Column ${n}: ${o}`),s.getCell(t,n).value=o}))}))}else o.insertParagraph(e,Word.InsertLocation.before);await n.sync()}catch(e){console.error("Error inserting table:",e)}}))}(n.EditorValue,n.ComponentKeyDataType)},t.appendChild(o)}))}))}window.addEventListener("hashchange",(()=>{"#/dashboard"===window.location.hash&&o&&(o=!1,document.getElementById("app-body").innerHTML="",async function(){try{const o=await fetch(`https://plsdevapp.azurewebsites.net/api/report/id/${t}`,{method:"GET",headers:{Authorization:`Bearer ${e}`}});if(!o.ok)throw new Error("Network response was not ok.");const a=await o.json();document.getElementById("header").innerHTML='\n    <button class="btn btn-dark me-2" id="mention">Suggestions</button>\n            <button class="btn btn-dark " id="aitag">AI Text Panel</button>\n\n    <\n',document.getElementById("mention").addEventListener("click",d),document.getElementById("aitag").addEventListener("click",l);const s=a.Data.Group.find((e=>"AIGroup"===e.DisplayName));n=s?s.GroupKey:[],r=a.Data.GroupKeyAll.filter((e=>"TABLE"===e.ComponentKeyDataType||"TEXT"===e.ComponentKeyDataType))}catch(e){console.error("Error fetching glossary data:",e)}}())})),Office.onReady((e=>{e.host===Office.HostType.Word&&(document.getElementById("app-body").style.display="flex",document.getElementById("editor"),window.location.hash="#/login",async function(){try{await Word.run((async e=>{const n=e.document.properties.customProperties;n.load("items"),await e.sync();const o=n.items.find((e=>"DocumentID"===e.key));o?(t=o.value,a()):(t="1268",a())}))}catch(e){console.error("Error retrieving custom property:",e)}}())}))}(),e=a(14385),t=a.n(e),n=new URL(a(58394),a.b),t()(n)}();
//# sourceMappingURL=taskpane.js.map