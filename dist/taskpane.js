!function(){"use strict";var e,t,n,o,c={14385:function(e){e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},98362:function(e,t,n){e.exports=n.p+"assets/logo-filled.png"},58394:function(e,t,n){e.exports=n.p+"c3fd0b707f9d09eda486.css"}},r={};function l(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return c[e](n,n.exports,l),n.exports}l.m=c,l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,{a:t}),t},l.d=function(e,t){for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;l.g.importScripts&&(e=l.g.location+"");var t=l.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=e}(),l.b=document.baseURI||self.location.href,function(){let e,t=!1;async function n(){try{await Word.run((async n=>{document.getElementById("run").style.display="none",document.getElementById("loader").style.display="block";const o=n.document.body;e.map((e=>{const t=o.search(e.ClinicalTerm,{matchCase:!0,matchWholeWord:!0});return t.load("items"),t})).forEach((e=>{e.items.forEach((e=>{e.font.highlightColor="yellow"}))})),document.getElementById("loader").style.display="none",document.getElementById("Clear").style.display="block",t=!0,await n.sync()})),console.log("Glossary applied successfully")}catch(e){console.error("Error applying glossary:",e),console.log("Error applying glossary. Please try again.")}}async function o(){try{await Word.run((async n=>{if(e){document.getElementById("Clear").style.display="none",document.getElementById("run").style.display="none",document.getElementById("loader").style.display="block";const o=n.document.body;e.map((e=>{const t=o.search(e.ClinicalTerm,{matchCase:!1,matchWholeWord:!0});return t.load("items"),t})).forEach((e=>{e.items.forEach((e=>{e.font.highlightColor="white"}))})),document.getElementById("loader").style.display="none",document.getElementById("run").style.display="block",t=!1,function(){const e=document.getElementById("highlighted-text");e&&(e.innerHTML="")}()}})),console.log("Glossary cleared successfully")}catch(e){console.error("Error clearing glossary:",e)}}async function c(){t&&await async function(){try{await Word.run((async t=>{const n=t.document.getSelection();if(n.load("text, font.highlightColor"),n.text){const t=e.map((e=>{const t=n.search(e.ClinicalTerm,{matchCase:!1,matchWholeWord:!0});return t.load("items"),t})),o=[];t.forEach((e=>{e.items.forEach((e=>{o.push(e.text)}))})),function(t){const n=document.getElementById("highlighted-text");if(n){n.innerHTML="";const o={};t.forEach((t=>{e.forEach((e=>{e.ClinicalTerm===t&&(o[e.ClinicalTerm]||(o[e.ClinicalTerm]=[]),o[e.ClinicalTerm].includes(e.LayTerm)||o[e.ClinicalTerm].push(e.LayTerm))}))})),Object.keys(o).forEach((e=>{const t=document.createElement("div");t.className="box";const c=document.createElement("h3");c.textContent=e,t.appendChild(c),o[e].forEach((n=>{const o=document.createElement("div");o.className="sub-box",o.textContent=n,o.addEventListener("click",(async()=>{await async function(e,t){try{await Word.run((async n=>{const o=n.document.getSelection();if(o.load("text"),o.text.includes(e)){const c=o.search(e,{matchCase:!1,matchWholeWord:!0});c.load("items"),c.items.forEach((e=>{e.insertText(t,"replace"),e.font.highlightColor="white"})),await n.sync(),console.log(`Replaced '${e}' with '${t}' and removed highlight in the document.`)}else console.log(`Selected text does not contain '${e}'.`)}))}catch(e){console.error("Error replacing term:",e)}}(e,n),t.remove()})),t.appendChild(o)})),n.appendChild(t)}))}}(o)}else console.log("No text is selected.")}))}catch(e){console.error("Error displaying glossary:",e)}}()}Office.onReady((async t=>{t.host===Office.HostType.Word&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=n,document.getElementById("Clear").onclick=o,Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged,c),await async function(){document.getElementById("run").style.display="none",document.getElementById("Clear").style.display="none",document.getElementById("run")?.setAttribute("disabled","true"),document.getElementById("Clear")?.setAttribute("disabled","true");try{const t=await fetch("https://plsdevapp.azurewebsites.net/api/glossary-template/id/3",{method:"GET",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJOYW1lIjoiYWtoaWxybyIsIk5hbWVJZGVudGlmaWVyIjoiMTQwOCIsIlVzZXJJRCI6IjE0MDgiLCJVc2VyTmFtZSI6ImFraGlscm8iLCJFbWFpbCI6ImFraGlsLmFAcGFjZXdpc2RvbS5jb20iLCJDbGllbnRJRCI6IjEwMDU5IiwiVEFBdXRoX0RCTmFtZSI6IlRBX0F1dGhfUGFjZURldiIsIkVycm9yTXNnIjoiXCJcIiIsIklzVmFsaWQiOiJUcnVlIiwiQXBwbGljYXRpb25Db2RlIjoiTElOSyIsImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd3MvMjAwOC8wNi9pZGVudGl0eS9jbGFpbXMvcm9sZSI6IlVzZXIiLCJBbm9ueW1pemF0aW9uX0RCTmFtZSI6IiIsIkJFQUNPTl9EQk5hbWUiOiIiLCJMSU5LX0RCTmFtZSI6IkxpbmtfTU1TIiwiUmVnaXN0cnlfREJOYW1lIjoiIiwiZXhwIjoxNzIyOTQyNDQ4LCJpc3MiOiJodHRwOi8vVHJpYWxBc3N1cmUuY29tIiwiYXVkIjoiaHR0cDovL1RyaWFsQXNzdXJlLmNvbSJ9.k-s_qBxCj-ArIIicYm_FRWv-332_0loUKLGuoPfmosw"}});if(!t.ok)throw new Error("Network response was not ok.");const n=await t.json();e=n.Data.GlossaryTemplateData}catch(e){console.error("Error fetching glossary data:",e)}finally{document.getElementById("run")?.removeAttribute("disabled"),document.getElementById("Clear")?.removeAttribute("disabled")}}(),await o())}))}(),e=l(14385),t=l.n(e),n=new URL(l(58394),l.b),o=new URL(l(98362),l.b),t()(n),t()(o)}();
//# sourceMappingURL=taskpane.js.map