{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/./src/taskpane/taskpane.html","webpack://office-addin-taskpane/./node_modules/html-loader/dist/runtime/getUrl.js","webpack://office-addin-taskpane/webpack/bootstrap","webpack://office-addin-taskpane/webpack/runtime/compat get default export","webpack://office-addin-taskpane/webpack/runtime/define property getters","webpack://office-addin-taskpane/webpack/runtime/global","webpack://office-addin-taskpane/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane/webpack/runtime/publicPath","webpack://office-addin-taskpane/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane/./src/taskpane/taskpane.ts"],"sourcesContent":["// Imports\nimport ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___ from \"../../node_modules/html-loader/dist/runtime/getUrl.js\";\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar ___HTML_LOADER_REPLACEMENT_0___ = ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___(___HTML_LOADER_IMPORT_0___);\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Contoso Task Pane Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css\\\"/> <link href=\\\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css\\\" rel=\\\"stylesheet\\\" integrity=\\\"sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC\\\" crossorigin=\\\"anonymous\\\"> <link rel=\\\"stylesheet\\\" href=\\\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\\\"> <link href=\\\"\" + ___HTML_LOADER_REPLACEMENT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <\" + \"script src=\\\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js\\\" integrity=\\\"sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM\\\" crossorigin=\\\"anonymous\\\"><\" + \"/script> <div class=\\\"header bg-dark mb-2\\\" id=\\\"header\\\"> </div> <main id=\\\"app-body\\\" class=\\\"d-block\\\"> <div id=\\\"ai-tag-list-container\\\" class=\\\"accordion\\\"></div> </main> </body> </html> \";\n// Exports\nexport default code;","\"use strict\";\n\nmodule.exports = function (url, options) {\n  if (!options) {\n    // eslint-disable-next-line no-param-reassign\n    options = {};\n  }\n  if (!url) {\n    return url;\n  }\n\n  // eslint-disable-next-line no-underscore-dangle, no-param-reassign\n  url = String(url.__esModule ? url.default : url);\n  if (options.hash) {\n    // eslint-disable-next-line no-param-reassign\n    url += options.hash;\n  }\n  if (options.maybeNeedQuotes && /[\\t\\n\\f\\r \"'=<>`]/.test(url)) {\n    return \"\\\"\".concat(url, \"\\\"\");\n  }\n  return url;\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\nlet jwt = '';\r\nlet documentID = ''\r\nlet aiTagList = [];\r\nlet initialised = true;\r\nlet availableKeys = [];\r\nlet layTerms = [];\r\n\r\n/* global document, Office, Word */\r\n\r\nwindow.addEventListener('hashchange', () => {\r\n  const hash = window.location.hash;\r\n  if (hash === '#/dashboard' && initialised) {\r\n    initialised = false;\r\n    displayMenu();\r\n\r\n  }\r\n});\r\n\r\n\r\nOffice.onReady((info) => {\r\n  if (info.host === Office.HostType.Word) {\r\n    document.getElementById(\"app-body\").style.display = \"flex\";\r\n    const editor = document.getElementById('editor');\r\n\r\n    window.location.hash = '#/login';\r\n    retrieveDocumentProperties()\r\n  }\r\n});\r\n\r\n\r\n// Example usage:\r\n\r\n\r\n\r\nasync function retrieveDocumentProperties() {\r\n  try {\r\n    await Word.run(async (context) => {\r\n      const properties = context.document.properties.customProperties;\r\n      properties.load(\"items\");\r\n\r\n      await context.sync();\r\n      const property = properties.items.find(prop => prop.key === 'DocumentID');\r\n      if (property) {\r\n        documentID = property.value;\r\n        login()\r\n      } else {\r\n        documentID='1268'\r\n        login();\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error retrieving custom property:\", error);\r\n  }\r\n\r\n}\r\n\r\n\r\nasync function login() {\r\n  // document.getElementById('header').innerHTML = ``\r\n\r\n  const sessionToken = sessionStorage.getItem('token');\r\n  console.log(sessionToken)\r\n  if (sessionToken) {\r\n    jwt = sessionToken;\r\n    window.location.hash = '#/dashboard';\r\n  } else {\r\n    loadLoginPage();\r\n  }\r\n\r\n}\r\n\r\nfunction loadLoginPage() {\r\n\r\n\r\n  document.getElementById('app-body').innerHTML = `\r\n    <div class=\"container mt-5\">\r\n      <form id=\"login-form\" class=\"p-4 border rounded\">\r\n        <div class=\"mb-3\">\r\n          <label for=\"organization\" class=\"form-label fw-bold\">Organization</label>\r\n          <input type=\"text\" class=\"form-control\" id=\"organization\" required>\r\n        </div>\r\n        <div class=\"mb-3\">\r\n          <label for=\"username\" class=\"form-label fw-bold\">Username</label>\r\n          <input type=\"text\" class=\"form-control\" id=\"username\" required>\r\n        </div>\r\n        <div class=\"mb-3\">\r\n          <label for=\"password\" class=\"form-label fw-bold\">Password</label>\r\n          <input type=\"password\" class=\"form-control\" id=\"password\" required>\r\n        </div>\r\n        <div class=\"d-grid\">\r\n          <button type=\"submit\" class=\"btn btn-primary\">Login</button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  `;\r\n\r\n  document.getElementById('login-form').addEventListener('submit', handleLogin);\r\n}\r\n\r\nasync function handleLogin(event) {\r\n  event.preventDefault();\r\n\r\n  // Get the values from the form fields\r\n  const organization = document.getElementById('organization').value;\r\n  const username = document.getElementById('username').value;\r\n  const password = document.getElementById('password').value;\r\n\r\n  try {\r\n    const response = await fetch('https://plsdevapp.azurewebsites.net/api/user/login', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        ClientName: organization,\r\n        Username: username,\r\n        Password: password\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Network response was not ok.');\r\n    }\r\n\r\n    const data = await response.json();\r\n    console.log('Login successful:', data);\r\n    jwt = data.Data.Token;\r\n    sessionStorage.setItem('token', jwt)\r\n\r\n    window.location.hash = '#/dashboard';\r\n\r\n    // Handle successful login (e.g., navigate to the next page or show a success message)\r\n\r\n  } catch (error) {\r\n    console.error('Error during login:', error);\r\n    // Handle login error (e.g., show an error message)\r\n  }\r\n}\r\n\r\nfunction displayMenu() {\r\n  document.getElementById('app-body').innerHTML = ``\r\n  // document.getElementById('aitag').addEventListener('click', redirectAI);\r\n  fetchDocument();\r\n\r\n}\r\n\r\nfunction redirectAI() {\r\n  initialised = true;\r\n  window.location.hash = '#/aitag'\r\n  // Call function to display the AI Tag List on the UI\r\n\r\n}\r\n\r\n\r\nasync function fetchDocument() {\r\n  try {\r\n    const response = await fetch(`https://plsdevapp.azurewebsites.net/api/report/id/${documentID}`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': `Bearer ${jwt}`\r\n      }\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Network response was not ok.');\r\n    }\r\n\r\n\r\n\r\n    const data = await response.json();\r\n    document.getElementById('header').innerHTML = `\r\n    <button class=\"btn btn-dark me-2\" id=\"mention\">Suggestions</button>\r\n            <button class=\"btn btn-dark \" id=\"aitag\">AI Text Panel</button>\r\n\r\n    <\r\n`\r\n// <button class=\"btn btn-dark me-2\" id=\"applyglossary\">Glossary</button>\r\n\r\n    document.getElementById('mention').addEventListener('click', displayMentions);\r\n    // document.getElementById('applyglossary').addEventListener('click', fetchGlossary);\r\n\r\n    document.getElementById('aitag').addEventListener('click', displayAiTagList);\r\n\r\n\r\n\r\n    // Extracting the relevant AI group from the response\r\n    const aiGroup = data['Data'].Group.find(element => element.DisplayName === 'AIGroup');\r\n    aiTagList = aiGroup ? aiGroup.GroupKey : [];\r\n\r\n    availableKeys = data['Data'].GroupKeyAll.filter(element => element.ComponentKeyDataType === 'TABLE' || element.ComponentKeyDataType === 'TEXT');\r\n\r\n    // Call function to display the AI Tag List on the UI\r\n\r\n  } catch (error) {\r\n    console.error('Error fetching glossary data:', error);\r\n  }\r\n}\r\n\r\nasync function fetchAIHistory(tag) {\r\n  try {\r\n    const response = await fetch(`https://plsdevapp.azurewebsites.net/api/report/ai-history/${tag.ID}`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': `Bearer ${jwt}`\r\n      }\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Network response was not ok.');\r\n    }\r\n\r\n    const data = await response.json();\r\n    tag.FilteredReportHeadAIHistoryList = data['Data'] || [];\r\n    return tag.FilteredReportHeadAIHistoryList;\r\n\r\n  } catch (error) {\r\n    console.error('Error fetching AI history:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\nasync function generateRadioButtons(tag: any, index: number): Promise<string> {\r\n  if (!tag.FilteredReportHeadAIHistoryList || tag.FilteredReportHeadAIHistoryList.length === 0) {\r\n    await fetchAIHistory(tag);\r\n  }\r\n\r\n  if (tag.FilteredReportHeadAIHistoryList.length > 0) {\r\n    // Generate the HTML\r\n    const html = tag.FilteredReportHeadAIHistoryList.map((chat: any, j: number) => \r\n      `<div class=\"row chatbox\">\r\n        <div class=\"col-md-12 mt-2 p-2\">\r\n          <span class=\"ms-3\">\r\n            <i class=\"fa fa-copy text-secondary c-pointer\" title=\"Copy Response\" id=\"copyPrompt-${index}-${j}\"></i>\r\n          </span>\r\n          <span class=\"float-end w-75 me-3\">\r\n            <div class=\"form-control h-34 d-flex align-items-center dynamic-height user\">\r\n              ${chat.Prompt}\r\n            </div>\r\n          </span>\r\n        </div>\r\n        <div class=\"col-md-12 mt-2 p-2 d-flex align-items-center\">\r\n          <span class=\"radio-select\">\r\n            <input class=\"form-check-input c-pointer\" type=\"radio\" name=\"flexRadioDefault-${index}\"\r\n              id=\"flexRadioDefault1-${index}-${j}\" ${chat.Selected === 1 ? 'checked' : ''}>\r\n          </span>\r\n          <span class=\"ms-2 w-75\">\r\n            <div class=\"form-control h-34 d-flex align-items-center dynamic-height ai-reply ${chat.Selected === 1 ? 'ai-selected-reply' : 'bg-light'}\">\r\n              ${chat.Response}\r\n            </div>\r\n          </span>\r\n          <span class=\"ms-2\">\r\n            <i class=\"fa fa-copy text-secondary c-pointer\" title=\"Copy Response\" id=\"copyResponse-${index}-${j}\"></i>\r\n          </span>\r\n        </div>\r\n      </div>`\r\n    ).join('');\r\n\r\n    // Attach event listeners after the HTML is inserted\r\n    setTimeout(() => {\r\n      tag.FilteredReportHeadAIHistoryList.forEach((chat: any, j: number) => {\r\n        document.getElementById(`copyPrompt-${index}-${j}`)?.addEventListener('click', () => copyText(chat.Prompt));\r\n        document.getElementById(`copyResponse-${index}-${j}`)?.addEventListener('click', () => copyText(chat.Response));\r\n        document.getElementById(`flexRadioDefault1-${index}-${j}`)?.addEventListener('change', () => onRadioChange(index, j));\r\n      });\r\n    }, 0);\r\n\r\n    return html;\r\n  } else {\r\n    return '<div>No AI history available.</div>';\r\n  }\r\n}\r\n\r\n// Your existing copyText function\r\nfunction copyText(text: string) {\r\n  // Copy text to clipboard logic\r\n  const tempTextArea = document.createElement('textarea');\r\n  tempTextArea.value = text;\r\n  document.body.appendChild(tempTextArea);\r\n  tempTextArea.select();\r\n  document.execCommand('copy');\r\n  document.body.removeChild(tempTextArea);\r\n\r\n}\r\n\r\n\r\nasync function displayAiTagList() {\r\n\r\n  const container = document.getElementById('app-body');\r\n  container.innerHTML = ''; // Clear any previous content\r\n\r\n  for (let i = 0; i < aiTagList.length; i++) {\r\n    const tag = aiTagList[i];\r\n    const accordionItem = document.createElement('div');\r\n    accordionItem.classList.add('accordion-item');\r\n\r\n    const headerId = `flush-headingOne-${i}`;\r\n    const collapseId = `flush-collapseOne-${i}`;\r\n\r\n    const radioButtonsHTML = await generateRadioButtons(tag, i);\r\n\r\n    accordionItem.innerHTML = `\r\n      <h2 class=\"accordion-header\" id=\"${headerId}\">\r\n        <button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\"\r\n          data-bs-target=\"#${collapseId}\" aria-expanded=\"false\" aria-controls=\"${collapseId}\">\r\n          ${tag.DisplayName}\r\n        </button>\r\n      </h2>\r\n      <div id=\"${collapseId}\" class=\"accordion-collapse collapse\" aria-labelledby=\"${headerId}\">\r\n        <div class=\"accordion-body\">\r\n          ${radioButtonsHTML}\r\n        \r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    container.appendChild(accordionItem);\r\n  }\r\n\r\n  // Add event listeners after rendering\r\n  addAccordionListeners();\r\n  addCopyListeners();\r\n}\r\n\r\nfunction addAccordionListeners() {\r\n  const accordionButtons = document.querySelectorAll('.accordion-button');\r\n\r\n  accordionButtons.forEach(button => {\r\n    button.addEventListener('click', function () {\r\n      const collapseElement = this.nextElementSibling;\r\n\r\n      // Check if the element exists before accessing its classList\r\n      if (collapseElement && collapseElement.classList) {\r\n        collapseElement.classList.toggle('show');\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nfunction addCopyListeners() {\r\n  const copyIcons = document.querySelectorAll('.fa-copy');\r\n  copyIcons.forEach(icon => {\r\n    icon.addEventListener('click', function () {\r\n      const textToCopy = this.closest('.p-2').querySelector('.form-control').textContent;\r\n    });\r\n  });\r\n}\r\n\r\nfunction onRadioChange(tagIndex, chatIndex) {\r\n  // Handle the radio button change logic here\r\n  console.log(`Radio button changed for tagIndex ${tagIndex}, chatIndex ${chatIndex}`);\r\n}\r\n\r\nfunction selectResponse(tagIndex, chatIndex) {\r\n  // Handle the response selection logic here\r\n  console.log(`Response selected for tagIndex ${tagIndex}, chatIndex ${chatIndex}`);\r\n}\r\n\r\n\r\nasync function fetchGlossary() {\r\n  document.getElementById('app-body').innerHTML = `\r\n  <div id=\"button-container\">\r\n\r\n          <div class=\"loader\" id=\"loader\"></div>\r\n\r\n        <div id=\"highlighted-text\"></div>`\r\n\r\n  try {\r\n    const response = await fetch('https://plsdevapp.azurewebsites.net/api/glossary-template/id/3', {\r\n      method: 'GET', // or 'POST', depending on your API\r\n      headers: {\r\n        'Authorization': `Bearer ${jwt}`\r\n\r\n      }\r\n    });\r\n    if (!response.ok) {\r\n      throw new Error('Network response was not ok.');\r\n    }\r\n\r\n    const data = await response.json();\r\n    layTerms = data.Data.GlossaryTemplateData;\r\n\r\n    // alert('Glossary data loaded successfully.');\r\n  } catch (error) {\r\n    console.error('Error fetching glossary data:', error);\r\n    // Optionally show an error message to the user\r\n    // alert('Error fetching glossary data.');\r\n  }\r\n\r\n\r\n}\r\n\r\n\r\n\r\nfunction displayMentions() {\r\n  const htmlBody = `\r\n    <div class=\"container mt-3\">\r\n      <div class=\"card\">\r\n        <div class=\"card-header\">\r\n          <h5 class=\"card-title\">Search Suggestions</h5>\r\n        </div>\r\n        <div class=\"card-body\">\r\n          <div class=\"form-group\">\r\n            <input type=\"text\" id=\"search-box\" class=\"form-control\" placeholder=\"Search Suggestions...\" />\r\n          </div>\r\n          <ul id=\"suggestion-list\" class=\"list-group mt-2\"></ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n`\r\n  document.getElementById('app-body').innerHTML = htmlBody\r\n  const searchBox = document.getElementById('search-box');\r\n  const suggestionList = document.getElementById('suggestion-list');\r\n\r\n  // Function to filter and display suggestions\r\n  function updateSuggestions() {\r\n    const searchTerm = searchBox.value.toLowerCase();\r\n    suggestionList.innerHTML = '';\r\n\r\n    // Filter mention list based on search term\r\n    const filteredMentions = availableKeys.filter(mention =>\r\n      mention.DisplayName.toLowerCase().includes(searchTerm)\r\n    );\r\n\r\n    // Render filtered suggestions\r\n    filteredMentions.forEach(mention => {\r\n      const listItem = document.createElement('li');\r\n      listItem.className = 'list-group-item list-group-item-action';\r\n      listItem.textContent = mention.DisplayName;\r\n      listItem.onclick = () => {\r\n        // Replace # with the selected value (adjust as needed)\r\n        searchBox.value = '';\r\n        suggestionList.innerHTML = '';\r\n        replaceMention(mention.EditorValue, mention.ComponentKeyDataType)\r\n        // Clear suggestions after selection\r\n      };\r\n      suggestionList.appendChild(listItem);\r\n    });\r\n  }\r\n\r\n  // Add input event listener to the search box\r\n  searchBox.addEventListener('input', updateSuggestions);\r\n}\r\n\r\n\r\n\r\n\r\nexport async function replaceMention(word: string, type: any) {\r\n  return Word.run(async (context) => {\r\n    try {\r\n      // Get the current selection\r\n      const selection = context.document.getSelection();\r\n\r\n      // Insert an empty paragraph to ensure there's a valid insertion point\r\n\r\n      if (type === 'TABLE') {\r\n\r\n        const paragraph = selection.insertParagraph(\"\", Word.InsertLocation.before);\r\n\r\n        // Parse the HTML string to extract table data\r\n        const parser = new DOMParser();\r\n        const doc = parser.parseFromString(word, 'text/html');\r\n        const tableElement = doc.querySelector('table');\r\n\r\n        if (!tableElement) {\r\n          throw new Error('No table found in the provided HTML.');\r\n        }\r\n\r\n        // Extract rows\r\n        const rows = Array.from(tableElement.querySelectorAll('tr'));\r\n\r\n        if (rows.length === 0) {\r\n          throw new Error('The table does not contain any rows.');\r\n        }\r\n\r\n        // Determine maximum number of columns\r\n        const maxCols = Math.max(...rows.map(row => row.querySelectorAll('td, th').length));\r\n\r\n        // Create a table in Word\r\n        const table = paragraph.insertTable(rows.length, maxCols, Word.InsertLocation.after);\r\n\r\n        // Fill the table with data\r\n        rows.forEach((row, rowIndex) => {\r\n          const cells = Array.from(row.querySelectorAll('td, th'));\r\n          cells.forEach((cell, cellIndex) => {\r\n            const cellText = cell.textContent?.trim() || '';\r\n            console.log(`Row ${rowIndex}, Column ${cellIndex}: ${cellText}`);\r\n\r\n            const cellObj = table.getCell(rowIndex, cellIndex);\r\n            cellObj.value = cellText\r\n          });\r\n        });\r\n\r\n        // Synchronize the document state\r\n\r\n      } else {\r\n        const paragraph = selection.insertParagraph(word, Word.InsertLocation.before);\r\n\r\n      }\r\n      await context.sync();\r\n\r\n    } catch (error) {\r\n      console.error('Error inserting table:', error);\r\n    }\r\n  });\r\n}\r\n\r\n\r\n"],"names":["___HTML_LOADER_IMPORT_0___","module","exports","url","options","String","__esModule","default","hash","maybeNeedQuotes","test","concat","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","m","n","getter","d","a","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","length","i","Error","replace","p","b","baseURI","self","href","jwt","documentID","aiTagList","initialised","availableKeys","async","login","sessionToken","sessionStorage","getItem","console","log","getElementById","innerHTML","addEventListener","handleLogin","event","preventDefault","organization","value","username","password","response","fetch","method","headers","body","JSON","stringify","ClientName","Username","Password","ok","data","json","Data","Token","setItem","error","generateRadioButtons","tag","index","FilteredReportHeadAIHistoryList","ID","fetchAIHistory","html","map","chat","j","Prompt","Selected","Response","join","setTimeout","forEach","copyText","onRadioChange","tagIndex","chatIndex","text","tempTextArea","createElement","appendChild","select","execCommand","removeChild","displayAiTagList","container","accordionItem","classList","add","headerId","collapseId","radioButtonsHTML","DisplayName","querySelectorAll","button","collapseElement","nextElementSibling","toggle","icon","closest","querySelector","textContent","displayMentions","searchBox","suggestionList","searchTerm","toLowerCase","filter","mention","includes","listItem","className","onclick","word","type","Word","run","selection","context","getSelection","paragraph","insertParagraph","InsertLocation","before","tableElement","DOMParser","parseFromString","rows","Array","from","maxCols","Math","max","row","table","insertTable","after","rowIndex","cell","cellIndex","cellText","trim","getCell","sync","replaceMention","EditorValue","ComponentKeyDataType","aiGroup","Group","find","element","GroupKey","GroupKeyAll","fetchDocument","Office","onReady","info","host","HostType","style","display","properties","customProperties","load","property","items","retrieveDocumentProperties","URL"],"sourceRoot":""}